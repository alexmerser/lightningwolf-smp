{% extends 'jqueryuibootstrap_layout.html' %}
{% import 'macros/messages.html' as messages_macros with context -%}
{% import 'macros/filters.html' as filters_macros %}
{% import 'macros/pager.html' as pager_macros %}
{% import 'macros/batch_actions.html' as batch_actions_macros %}
{% import 'macros/actions.html' as actions_macros %}

{% block container %}
    <h1>Users List {{ current_user }}</h1>
    {{ messages_macros.messages() }}

    <div class="btn-toolbar">
        <div class="btn-group">
            {% if filter %}{{ filters_macros.filter_button('filtersBootstrapGeneratorModal') }}{%  endif %}
        </div>
        <div class="btn-group pull-right">
            <a title="New" class="btn btn-primary " href="{{ url_for('user.user_create') }}">
                <i class="icon-plus icon-white"></i> New
            </a>
        </div>
    </div>

    {% if filter %}
    {{ filters_macros.filter_modal(id='filtersBootstrapGeneratorModal', filter_form=filter, action=url_for('user.user_filter')) }}
    {%  endif %}

    <form class="form-inline" action="{{ url_for('user.user_batch') }}" method="post">
        <table class="table table-hover table-striped">
            <thead>
                <tr>
                    {% if batch_actions %}{{ batch_actions_macros.batch_head_row(id='lw_admin_list_batch_checkbox') }}{%  endif %}
                    <th>Id</th>
                    <th>Username</th>
                    <th>E-mail</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    <th colspan="{% if batch_actions %}5{% else %}4{%  endif %}">{{ pager_macros.footer(pager) }}</th>
                </tr>
            </tfoot>
            <tbody>
            {% for item in list %}
                <tr>
                    {% if batch_actions %}{{ batch_actions_macros.batch_body_row(class='lw_admin_batch_checkbox', value=item.id) }}{%  endif %}
                    <td>{{ item.id }}</td>
                    <td>{{ item.username }}</td>
                    <td>{{ item.email }}</td>
                    <td>
                        <div class="btn-group pull-right">
                            <a title="Edit" class="btn btn-small" href="{{ url_for('user.user_edit', id=item.id) }}"><i class="icon-edit"></i> Edit</a>
                            {% if delete_action %}{% if item.username != current_user.get_username() %}
                            {{ actions_macros.delete_action(delete_form=delete_action, url=url_for('user.user_del', id=item.id)) }}
                            {% endif %}{% endif %}
                        </div>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        {% if pager.have_to_paginate %}{{ pager_macros.pager(pager=pager, page=page, url=url_for('user.user_list')) }}{% endif %}
        {% if batch_actions %}{{ batch_actions_macros.batch_script(id='lw_admin_list_batch_checkbox', class='lw_admin_batch_checkbox') }}{%  endif %}
        <div class="btn-toolbar">
            <div class="btn-group">
                {% if batch_actions %}{{ batch_actions_macros.batch_buttons(batch_form=batch_actions) }}{% endif %}
            </div>
            <div class="btn-group pull-right">
                <a title="New" class="btn btn-primary " href="{{ url_for('user.user_create') }}"><i class="icon-plus icon-white"></i> New</a>
            </div>
        </div>
    </form>
{% endblock %}